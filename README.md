# stateMDS
## Overview
In this analysis, we define the functional state of a given brain network (e.g., the default mode network, salience network, or other networks of interest) as the spatial pattern of multi-voxel activity captured at a single time point during resting-state functional magnetic resonance imaging (rsfMRI). Specifically, each state is represented by the distribution of BOLD signal intensities across all voxels within the predefined network at a given frame (TR).

A state transition is defined as a temporal change in this multi-voxel pattern—i.e., when the configuration of voxel-level activity differs from one time point to the next. By quantifying these frame-by-frame changes, we can capture the dynamic trajectory of a network’s activity over time.

To visualize and analyze these dynamics, we use multidimensional scaling (MDS) to project the high-dimensional voxel-wise activity patterns into lower dimensional  space (e.g., 2D, 3D or 4D). In this lower dimensional representation, each point corresponds to a time-specific functional state, and the distance between points reflects the degree of dissimilarity between those states. This approach allows us to assess network stability, state transitions, and their relation to individual differences (e.g., psychological/cognitive resilience).

This method can be applied to any network of interest defined by an atlas or custom ROI set.

## 📁 Structure

```text
.
├── data/               # Input data
│   └── voxels/         # Voxel-wise fMRI time series (one CSV per subject)
│       ├── subject1_voxels.csv
│       └── subject2_voxels.csv
│
├── output/             # All outputs generated by the analysis
│   ├── arrowdis/       # Stepwise arrow distances for each subject
│   └── MDSpoint/       # Low-dimensional MDS coordinates for each subject
│
├── R/                  # Main R script(s) for analysis
│   └── run_mds_analysis.R
│
├── brainMDS.Rproj      # RStudio project file (sets project root)
├── README.md           # Project overview, usage, and instructions

```


## 📦 Requirements

Install the following R packages:

```r
install.packages(c("vegan", "ggplot2", "readr", "here", "fs"))


▶️ How to Run the Analysis
Open the DMN_MDS_Analysis.Rproj in RStudio.

Make sure the input voxel data (*_voxels.csv) are in the data/voxels/ folder.

Run the script:
source("run_MDS_analysis.R")

This script will:

Load and preprocess all voxel data

Run MDS on each subject

Compute arrow distances across time

Save outputs into output/arrowdis/ and output/MDSpoint/


📤 Outputs
output/MDSpoint/
For each subject: a CSV with 2D/3D/4D MDS coordinates over time.

output/arrowdis/
For each subject: step-by-step arrow distances across time.

MDS_Velocity_Summary.csv: summary for all subjects (total distance, mean distance, stress, convergence).

📌 Notes
Paths are handled via the here package, so the project must be run from within the project root or with the .Rproj open in RStudio.
